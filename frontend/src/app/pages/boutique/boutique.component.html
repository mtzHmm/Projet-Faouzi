<div class="boutique-page">
  <!-- En-tête de la page -->
  <div class="page-header">
    <h1><i class="fas fa-shopping-bag"></i> Boutique</h1>
    <p>Découvrez nos produits tendance</p>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="loading-spinner"></div>
    <p>Chargement des produits de la boutique...</p>
  </div>

  <!-- Filtres par catégorie - Only show after loading -->
  <div *ngIf="!isLoading && dataLoaded" class="category-filters">
    <button 
      *ngFor="let category of categories"
      class="filter-btn"
      [class.active]="selectedCategory === category"
      (click)="filterByCategory(category)">
      {{ category }}
    </button>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !isLoading && dataLoaded" class="error-state">
    <i class="fas fa-exclamation-triangle"></i>
    <p>{{ error }}</p>
    <button class="retry-btn" (click)="loadBoutiqueCategoriesFromDB()">
      <i class="fas fa-redo"></i> Réessayer
    </button>
  </div>

  <!-- No Products State -->
  <div *ngIf="!isLoading && dataLoaded && !error && filteredProducts.length === 0" class="empty-state">
    <i class="fas fa-shopping-bag"></i>
    <p>Aucun produit disponible dans cette catégorie</p>
  </div>

  <!-- Grille de produits -->
  <div class="products-grid" *ngIf="!isLoading && dataLoaded && !error && filteredProducts.length > 0">
    <div class="product-card" *ngFor="let product of filteredProducts">
      <div class="product-image">
        <div class="product-placeholder">
          <span class="product-emoji">{{ getProductEmoji(product.category_name || 'Vêtements') }}</span>
        </div>
        <div class="product-overlay">
          <button class="quick-view-btn">
            <i class="fas fa-eye"></i>
          </button>
        </div>
      </div>
      
      <div class="product-info">
        <div class="product-store">{{ product.restaurant }}</div>
        <h3 class="product-name">{{ product.name }}</h3>
        <p class="product-description">{{ product.description }}</p>
        <div class="product-meta">
          <span class="product-category">{{ product.category_name || 'Vêtements' }}</span>
          <div class="product-price">{{ product.price | number:'1.2-2' }} DT</div>
        </div>
        
        <button 
          class="add-to-cart-btn"
          (click)="addToCart(product)">
          <i class="fas fa-cart-plus"></i>
          Ajouter au panier
        </button>
      </div>
    </div>
  </div>

  <!-- Panier flottant -->
  <div class="floating-cart" *ngIf="getTotalItems() > 0">
    <div class="cart-summary">
      <div class="cart-info">
        <span class="cart-items">{{ getTotalItems() }} article(s)</span>
        <span class="cart-total">{{ getTotalPrice() | currency:'EUR':'symbol':'1.2-2' }}</span>
      </div>
      <button class="checkout-btn" routerLink="/cart">
        <i class="fas fa-shopping-cart"></i>
        Voir le panier
      </button>
    </div>
    
    <!-- Liste des articles dans le panier -->
    <div class="cart-items-list">
      <div class="cart-item" *ngFor="let item of cart">
        <img [src]="item.image" [alt]="item.name" class="cart-item-image">
        <div class="cart-item-info">
          <span class="cart-item-name">{{ item.name }}</span>
          <span class="cart-item-price">{{ item.price | number:'1.2-2' }} DT</span>
        </div>
        <button class="remove-item-btn" (click)="removeFromCart(item)">
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Message si aucun produit -->
  <div class="empty-state" *ngIf="filteredProducts.length === 0">
    <i class="fas fa-shopping-bag"></i>
    <h3>Aucun produit trouvé</h3>
    <p>Essayez de changer votre filtre de catégorie</p>
  </div>
</div>