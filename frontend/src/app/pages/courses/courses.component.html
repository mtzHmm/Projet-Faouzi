<div class="courses-page">
  <!-- En-tête de la page -->
  <div class="page-header">
    <h1><i class="fas fa-shopping-basket"></i> Courses</h1>
    <p>Produits frais livrés chez vous</p>
  </div>

  <!-- Filtres par catégorie -->
  <div class="category-filters">
    <button 
      *ngFor="let category of categories"
      class="filter-btn"
      [class.active]="selectedCategory === category"
      (click)="filterByCategory(category)">
      <span class="product-emoji">{{ getProductEmoji(category || 'Épicerie') }}</span>
      {{ category }}
    </button>
  </div>

  <!-- Loading state -->
  <div class="loading-state" *ngIf="isLoading && !dataLoaded">
    <div class="loading-spinner"></div>
    <p>Chargement des produits courses...</p>
  </div>

  <!-- Grille de produits -->
  <div class="products-grid" *ngIf="!isLoading || dataLoaded">
    <div class="product-card" *ngFor="let product of filteredProducts">
      <div class="product-image">
        <img [src]="product.image" [alt]="product.name" />
        <div class="stock-badge" [class.out-of-stock]="!product.inStock">
          <span *ngIf="product.inStock">En stock</span>
          <span *ngIf="!product.inStock">Rupture</span>
        </div>
        <div class="product-overlay">
          <button class="quick-view-btn">
            <i class="fas fa-eye"></i>
          </button>
        </div>
      </div>
      
      <div class="product-info">
        <div class="product-store">{{ product.restaurant }}</div>
        <h3 class="product-name">{{ product.name }}</h3>
        <p class="product-description">{{ product.description }}</p>
        <div class="product-meta">
          <span class="product-category">{{ product.category_name || 'Épicerie' }}</span>
          <div class="product-price-unit">
            <div class="product-price">{{ product.price | currency:'EUR':'symbol':'1.2-2' }}</div>
            <div class="product-unit" *ngIf="product.unit">/ {{ product.unit }}</div>
          </div>
        </div>
        
        <button 
          class="add-to-cart-btn"
          [class.out-of-stock-btn]="!product.inStock"
          [disabled]="!product.inStock"
          (click)="addToCart(product)">
          <i class="fas fa-cart-plus" *ngIf="product.inStock"></i>
          <i class="fas fa-times" *ngIf="!product.inStock"></i>
          <span *ngIf="product.inStock">Ajouter au panier</span>
          <span *ngIf="!product.inStock">Non disponible</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Panier flottant -->
  <div class="floating-cart" *ngIf="getTotalItems() > 0">
    <div class="cart-summary">
      <div class="cart-info">
        <span class="cart-items">{{ getTotalItems() }} article(s)</span>
        <span class="cart-total">{{ getTotalPrice() | currency:'EUR':'symbol':'1.2-2' }}</span>
      </div>
      <button class="checkout-btn" routerLink="/cart">
        <i class="fas fa-shopping-basket"></i>
        Voir le panier
      </button>
    </div>
    
    <!-- Liste des articles dans le panier -->
    <div class="cart-items-list">
      <div class="cart-item" *ngFor="let item of cart">
        <img [src]="item.image" [alt]="item.name" class="cart-item-image">
        <div class="cart-item-info">
          <span class="cart-item-name">{{ item.name }}</span>
          <div class="cart-item-details">
            <span class="cart-item-unit" *ngIf="item.unit">{{ item.unit }}</span>
            <span class="cart-item-price">{{ item.price | currency:'EUR':'symbol':'1.2-2' }}</span>
          </div>
        </div>
        <button class="remove-item-btn" (click)="removeFromCart(item)">
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>
    
    <div class="delivery-notice">
      <i class="fas fa-truck"></i>
      <span>Livraison gratuite dès 30€ d'achat</span>
    </div>
  </div>

  <!-- Message si aucun produit -->
  <div class="empty-state" *ngIf="filteredProducts.length === 0 && !isLoading && dataLoaded">
    <i class="fas fa-shopping-basket"></i>
    <h3>Aucun produit trouvé</h3>
    <p>Essayez de changer votre filtre de catégorie</p>
  </div>
</div>