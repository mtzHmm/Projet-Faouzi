<div class="admin-layout">
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="sidebar-header">
      <h2>Admin Panel</h2>
    </div>
    <nav class="sidebar-nav">
      <a routerLink="/admin" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="nav-item">
        <span class="nav-icon">âš¡</span>
        <span class="nav-text">Dashboard</span>
      </a>
      <a routerLink="/admin/orders" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">ğŸ“‹</span>
        <span class="nav-text">Orders</span>
      </a>
      <a routerLink="/user-management" routerLinkActive="active" class="nav-item users-nav">
        <span class="nav-icon">ğŸ‘¥</span>
        <span class="nav-text">Users</span>
      </a>
      <a routerLink="/admin/stats" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">ğŸ“Š</span>
        <span class="nav-text">Stats</span>
      </a>
    </nav>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <div class="user-management-container">
      <div class="header">
        <h1>User Management</h1>
        <div class="header-actions">
          <button class="btn-add" (click)="addNewUser()">
            <span class="add-icon">+</span>
            Add New User
          </button>
        </div>
      </div>

      <div class="filters">
        <div class="search-box">
          <input 
            type="text" 
            placeholder="Rechercher utilisateurs..." 
            [(ngModel)]="searchTerm"
            class="search-input"
          >
          <span class="search-icon">ğŸ”</span>
        </div>
        
        <select [(ngModel)]="selectedRole" class="role-filter">
          <option value="all">Tous les rÃ´les</option>
          <option value="admin">Administrateur</option>
          <option value="client">Client</option>
          <option value="provider">Fournisseur</option>
          <option value="delivery">Livreur</option>
        </select>
      </div>

      <div class="role-summary">
        <div class="summary-item">
          <span class="role-count admin">{{ getRoleCount('admin') }}</span>
          <span class="role-label">Admins</span>
        </div>
        <div class="summary-item">
          <span class="role-count client">{{ getRoleCount('client') }}</span>
          <span class="role-label">Clients</span>
        </div>
        <div class="summary-item">
          <span class="role-count provider">{{ getRoleCount('provider') }}</span>
          <span class="role-label">Fournisseurs</span>
        </div>
        <div class="summary-item">
          <span class="role-count delivery">{{ getRoleCount('delivery') }}</span>
          <span class="role-label">Livreurs</span>
        </div>
      </div>

      <div class="users-table-container">
        <table class="users-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Nom complet</th>
              <th>Email</th>
              <th>RÃ´le</th>
              <th>TÃ©lÃ©phone</th>
              <th>Statut</th>
              <th>Total Commandes</th>
              <th>Date d'inscription</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let user of filteredUsers" class="user-row">
              <td class="user-id">{{ user.id }}</td>
              <td class="user-name">
                <div class="name-info">
                  <strong>{{ user.fullName }}</strong>
                  <div *ngIf="user.storeInfo" class="store-info">
                    <small>{{ user.storeInfo.storeName }} - {{ user.storeInfo.storeType }}</small>
                  </div>
                </div>
              </td>
              <td class="user-email">{{ user.email }}</td>
              <td class="user-role">
                <select 
                  [value]="user.role"
                  (change)="onRoleChange(user.id, $event)"
                  class="role-select"
                  [ngClass]="getRoleClass(user.role)">
                  <option value="admin">Administrateur</option>
                  <option value="client">Client</option>
                  <option value="provider">Fournisseur</option>
                  <option value="delivery">Livreur</option>
                </select>
              </td>
              <td class="user-phone">{{ user.phone }}</td>
              <td class="user-status">
                <span class="status-badge" [class]="getStatusClass(user.status)">
                  {{ getStatusDisplayName(user.status) }}
                </span>
              </td>
              <td class="user-orders">
                <span class="orders-count">{{ user.totalOrders || 0 }}</span>
              </td>
              <td class="user-date">{{ user.registrationDate | date:'dd/MM/yyyy' }}</td>
              <td class="user-actions">
                <button class="action-btn edit-btn" (click)="editUser(user.id)" title="Modifier utilisateur">
                  <span class="icon">âœï¸</span>
                </button>
                <button class="action-btn toggle-btn" (click)="toggleUserStatus(user.id)" 
                        title="{{ user.status === 'active' ? 'Suspendre' : 'Activer' }}">
                  <span class="icon">{{ user.status === 'active' ? 'â¸ï¸' : 'â–¶ï¸' }}</span>
                </button>
                <button class="action-btn delete-btn" (click)="deleteUser(user.id)" title="Supprimer utilisateur">
                  <span class="icon">ğŸ—‘ï¸</span>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="pagination">
        <span class="results-count">Affichage de {{ filteredUsers.length }} utilisateur(s)</span>
      </div>
    </div>
  </div>
</div>