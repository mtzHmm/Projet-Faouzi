<div class="cart-container">
  <div class="cart-header">
    <h1>ðŸ›’ Panier d'Achat</h1>
    <p class="item-count" *ngIf="isLoggedIn">{{ cartItems.length }} article(s) - {{ userName }}</p>
    <p class="item-count" *ngIf="!isLoggedIn">Veuillez vous connecter</p>
  </div>

  <div class="cart-content">
    <div class="cart-items">
      <!-- Message si non connectÃ© -->
      <div *ngIf="!isLoggedIn" class="empty-cart">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
        <h2>Connexion requise</h2>
        <p>Veuillez vous connecter pour voir votre panier</p>
        <button class="btn btn-primary" routerLink="/signin">Se connecter</button>
      </div>

      <!-- Panier vide -->
      <div *ngIf="isLoggedIn && cartItems.length === 0" class="empty-cart">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <circle cx="9" cy="21" r="1"></circle>
          <circle cx="20" cy="21" r="1"></circle>
          <path d="m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
        </svg>
        <h2>Votre panier est vide</h2>
        <p>Ajoutez des articles pour commencer vos achats</p>
        <button class="btn btn-primary" (click)="continueShopping()">Continuer vos achats</button>
      </div>

      <div *ngIf="isLoggedIn && cartItems.length > 0" class="items-list">
        <div *ngFor="let item of cartItems" class="cart-item">
          <span class="item-emoji">{{ getCategoryEmoji(item.type) }}</span>
          <img [src]="item.image" [alt]="item.name" class="item-image">
          
          <div class="item-details">
            <h3>{{ item.name }}</h3>
            <p class="item-category">{{ item.category }} - {{ item.type }}</p>
            <p class="item-price">{{ item.price | number:'1.2-2' }} DT</p>
          </div>

          <div class="item-quantity">
            <button class="qty-btn" (click)="updateQuantity(item.id, item.quantity - 1)">âˆ’</button>
            <input type="number" [value]="item.quantity" readonly class="qty-input">
            <button class="qty-btn" (click)="updateQuantity(item.id, item.quantity + 1)">+</button>
          </div>

          <div class="item-total">
            <p class="total-price">{{ (item.price * item.quantity) | number:'1.2-2' }} DT</p>
          </div>

          <button class="btn-remove" (click)="removeItem(item.id)" title="Supprimer">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <polyline points="3 6 5 6 21 6"></polyline>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
              <line x1="10" y1="11" x2="10" y2="17"></line>
              <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <div class="cart-summary" *ngIf="isLoggedIn && cartItems.length > 0">
      <div class="summary-card">
        <h2>RÃ©sumÃ© de la commande</h2>
        
        <div class="summary-row">
          <span>Sous-total</span>
          <span>{{ subtotal | number:'1.2-2' }} DT</span>
        </div>

        <div class="summary-row">
          <span>Taxe (10%)</span>
          <span>{{ tax | number:'1.2-2' }} DT</span>
        </div>

        <div class="summary-row divider">
          <span>Livraison</span>
          <span>GRATUIT</span>
        </div>

        <div class="summary-row total">
          <span>Total</span>
          <span>{{ total | number:'1.2-2' }} DT</span>
        </div>

        <button class="btn btn-primary btn-checkout" (click)="checkout()">
          Passer la commande
        </button>

        <button class="btn btn-danger" (click)="clearCart()">
          Vider le panier
        </button>

        <button class="btn btn-secondary" (click)="continueShopping()">
          Continuer vos achats
        </button>
      </div>
    </div>
  </div>
</div>
