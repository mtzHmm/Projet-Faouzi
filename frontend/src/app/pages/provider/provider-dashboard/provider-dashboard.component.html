<div class="admin-layout">
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="sidebar-header">
      <h2>Provider Panel</h2>
      <div class="user-info" *ngIf="userName">
        <div class="user-avatar">üë§</div>
        <div class="user-details">
          <div class="user-name">{{ userName }}</div>
          <div class="store-name">{{ storeName }}</div>
        </div>
      </div>
    </div>
    <nav class="sidebar-nav">
      <a [routerLink]="['/provider']" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="nav-item">
        <span class="nav-icon">üè†</span>
        <span class="nav-text">Dashboard</span>
      </a>
      <a [routerLink]="['/provider/products']" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">üì¶</span>
        <span class="nav-text">Products</span>
      </a>
      <a [routerLink]="['/provider/orders']" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">üìã</span>
        <span class="nav-text">Orders</span>
      </a>
      <a [routerLink]="['/provider/inventory']" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">üìä</span>
        <span class="nav-text">Inventory</span>
      </a>
      <a [routerLink]="['/provider/reports']" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">üìà</span>
        <span class="nav-text">Reports</span>
      </a>
    </nav>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Header -->
    <div class="provider-header">
      <h1><i class="fas fa-store"></i> {{ storeName }} Dashboard</h1>
      <p *ngIf="userName">Welcome back, {{ userName }}! Manage your store and products</p>
      <p *ngIf="!userName">Manage your store and products</p>
    </div>

    <!-- Statistiques principales -->
    <div class="stats-grid" *ngIf="!loading; else loadingStats">
      <div class="stat-card products-stock">
        <div class="stat-content">
          <div class="stat-info">
            <p class="stat-label">Products in catalog</p>
            <h3 class="stat-value">{{ stats.totalProducts }}</h3>
            <div class="stat-bottom">
              <a [routerLink]="['/provider/products']" class="view-link">View Details</a>
            </div>
          </div>
          <div class="stat-icon">
            <i class="fas fa-boxes"></i>
          </div>
        </div>
      </div>

      <div class="stat-card total-orders">
        <div class="stat-content">
          <div class="stat-info">
            <p class="stat-label">Total orders</p>
            <h3 class="stat-value">{{ stats.totalOrders }}</h3>
            <div class="stat-bottom">
              <a [routerLink]="['/provider/orders']" class="view-link">View Orders</a>
            </div>
          </div>
          <div class="stat-icon">
            <i class="fas fa-shopping-cart"></i>
          </div>
        </div>
      </div>

      <div class="stat-card revenue">
        <div class="stat-content">
          <div class="stat-info">
            <p class="stat-label">Total revenue</p>
            <h3 class="stat-value">‚Ç¨{{ stats.totalRevenue | number:'1.2-2' }}</h3>
            <div class="stat-bottom">
              <a [routerLink]="['/provider/reports']" class="view-link">View Report</a>
            </div>
          </div>
          <div class="stat-icon">
            <i class="fas fa-euro-sign"></i>
          </div>
        </div>
      </div>

      <div class="stat-card pending-orders">
        <div class="stat-content">
          <div class="stat-info">
            <p class="stat-label">Pending orders</p>
            <h3 class="stat-value">{{ stats.pendingOrders }}</h3>
            <div class="stat-bottom">
              <a [routerLink]="['/provider/orders']" class="view-link">Process Now</a>
            </div>
          </div>
          <div class="stat-icon">
            <i class="fas fa-clock"></i>
          </div>
        </div>
      </div>
    </div>

    <ng-template #loadingStats>
      <div class="stats-grid">
        <div class="stat-card" *ngFor="let i of [1,2,3,4]">
          <div class="stat-content" style="opacity: 0.5;">
            <div class="stat-info">
              <p class="stat-label">Loading...</p>
              <h3 class="stat-value">--</h3>
            </div>
          </div>
        </div>
      </div>
    </ng-template>

    <!-- Actions rapides -->
    <div class="quick-actions-section">
      <h2><i class="fas fa-bolt"></i> Quick Actions</h2>
      <div class="quick-actions">
        <a 
          *ngFor="let action of quickActions" 
          [routerLink]="[action.route]" 
          class="action-btn"
          [style.background]="action.color">
          <i [class]="action.icon"></i>
          <span>{{ action.title }}</span>
        </a>
      </div>
    </div>

    <!-- Recent Orders -->
    <div class="recent-orders-section">
      <div class="section-header">
        <h2><i class="fas fa-clock"></i> Recent Orders ({{ recentOrders.length }})</h2>
        <a [routerLink]="['/provider/orders']" class="view-all-btn">View All</a>
      </div>
      
      <!-- Debug info -->
      <div style="padding: 10px; background: #f0f0f0; margin-bottom: 10px; font-size: 12px;">
        <strong>Debug:</strong> recentOrders array length = {{ recentOrders?.length || 0 }} | 
        Is array? {{ recentOrders?.constructor?.name }} |
        First order ID: {{ recentOrders?.[0]?.id }}
      </div>

      <div class="orders-table" *ngIf="recentOrders && recentOrders.length > 0; else noOrders">
        <div class="table-header">
          <div class="col-id">Order ID</div>
          <div class="col-customer">Customer</div>
          <div class="col-items">Items</div>
          <div class="col-total">Total</div>
          <div class="col-status">Status</div>
          <div class="col-time">Time</div>
        </div>
        
        <div class="table-row" *ngFor="let order of recentOrders; trackBy: trackByOrderId">
          <div class="col-id">#{{ order.id }}</div>
          <div class="col-customer">{{ order.customerName }}</div>
          <div class="col-items">{{ order.items }} item(s)</div>
          <div class="col-total">‚Ç¨{{ order.total | number:'1.2-2' }}</div>
          <div class="col-status">
            <span 
              class="status-badge" 
              [ngClass]="getStatusClass(order.status)">
              {{ getStatusText(order.status) }}
            </span>
          </div>
          <div class="col-time">{{ order.createdAt | date:'short' }}</div>
        </div>
      </div>

      <ng-template #noOrders>
        <div style="padding: 40px; text-align: center; color: #666;">
          <i class="fas fa-inbox" style="font-size: 48px; margin-bottom: 16px; opacity: 0.3;"></i>
          <p style="font-size: 18px; margin: 0;">No orders yet</p>
          <p style="font-size: 14px; margin-top: 8px; opacity: 0.7;">Orders will appear here once customers place them</p>
        </div>
      </ng-template>
    </div>
  </div>
</div>